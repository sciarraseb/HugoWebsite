---
title: "Expectation-Maximization Algorithm: A Method to Solve Latent Variable Problems" 
draft: false
summary: 'This is a summary of the post that brielfy explains the main points of the post to provide an anchor for the reader.' 
article_type: technical
csl: "`r system.file('rmd', 'apa7.csl', package = 'papaja')`"
output:
  bookdown::html_document2:
     keep_md: true
always_allow_html: true
bibFile: content/technical_content/em_algorithm/biblio.json    
tags: []
---   


```{r package_loading_1, include=F}
#load packages   
library(easypackages) 
packages <- c('devtools','tidyverse', 'RColorBrewer', 'parallel', 'data.table', 'kableExtra', 'ggtext', 'egg', 'papaja', 
              'ggbrace', 'cowplot', 'knitr', 'RefManageR', 'reticulate', 'gluedown')
libraries(packages)  
#use_python(python = "/usr/local/bin/python3.9")

knitr::opts_chunk$set(comment = NA)
# knitr hook to use Hugo highlighting options
knitr::knit_hooks$set(
  source = function(x, options) {
  hlopts <- options$hlopts
    paste0(
      "```", "r ",
      if (!is.null(hlopts)) {
      paste0("{",
        glue::glue_collapse(
          glue::glue('{names(hlopts)}={hlopts}'),
          sep = ","
        ), "}"
        )
      },
      "\n", glue::glue_collapse(x, sep = "\n"), "\n```\n"
    )
  }
)


knitr::knit_hooks$set(error = function(x, options) { 
  paste(c('\n\n:::{style="color:Crimson; background-color: SeaShell;"}',
       
        ':::'), collapse = '\n')
})


knitr::knit_hooks$set(error = function(x, options) { 
  paste(c("<div class = 'error'> ",
        gsub('^## Error', '**Error**', x),
        '</div>'), collapse = '\n')
})




```

```{r, error=TRUE}
1 + "a"
```

That's some text with a footnote.[^1]$^{,}$ This is a change. More9
[^1]: And that's the footnote (see Table \ref{tab:parameterValues}).

```{r results = 'hold', echo=T, eval=T, hlopts=list(hl_lines= paste0('[', 2,',', "3-5", ']'))}
#this is a comment  more comment my website m , . , y website my website my website
#my website my website my website my website my website my website my website 
#my website my website my website my website my website
print('my website my website my, , , ,. `  website my website my website my website my website my website my website my website my website my website my website my website my website')  
print(1 + 2)
mean(x = c(1, 2))
print('another')
print(NULL)
print(NA)
print(TRUE)
"\n"
list('number_measurements' = c(5, 7, 9, 11),
     'spacing' = c('equal', 'time_inc')) 
 
var <- function(x1, x2){
   
  if (x1 > 2) {print(x1)} 
  else {print (x2)}
}

``` 


Some explanatory text Some explanatory tex {{< cite "fine2019;george2000" >}} Some explanatory text Some explanatory textSome explanatory text{{< cite "fine2019;cole2003" >}}
Some explanatory text Some explanatory textSome explanatory  text{{< cite "fine2019;liu2022" >}}
[link](https://github.com/gohugoio/hugo/issues/9442)

If you liked how these _"generics"_ work in SystemVerilog and how the looks, check out the

```{python, eval=F, comment = 'python', hlopts=list(hl_lines= paste0('[', 2,',',3, ',', 4,']'), language = 'python'), engine.path = '/usr/bin/python3'}

tup = ('Groucho', 'Marx', 'Xavier')
list_ex = list(["food", 538, True, 1.454])
type(tup)  #tuple 
list_ex2 = list([1 + 2, "a" * 5, 3])  
 
#deleting variables 
del(list_ex2)
list_ex.count(2)  
```





```{r echo=F}
fit = lm(dist ~ speed, data = cars)
b = coef(summary(fit))
```


The slope of the regression is `r b[2, 1]`. This is gamma $\gamma\$. $\frac{1}{2}$ This is (see Equation \ref{eq:multiline}; another comment) {{< inline-src python >}}print('NULL'){{< /inline-src >}} 

$$
\begin{alignat}{2}
I & = \int \rho R^{2} dV & + P \nonumber \\\\
Y & = 1 + x
\label{eq:multiline}
\end{alignat}
$$

### Why the EM algorithm is needed?{#section}

```{bash, engine = 'bash',  eval=F, hlopts=list(hl_lines= paste0('[', 1,']'), language = 'bash')}
ls
 
cd ~/Desktop/Home/blog_posts
```

see [section](#section)

 Table \ref{tab:parameterValues}  Table \ref{tab:parameterValues}
Another paragraph begins and the spacing should not be too small from table above. {{< inline-src bash >}}cd ~/Desktop/Home/blog_posts{{< /inline-src >}} 

 Table \ref{tab:parameterValues1}
 Table \ref{tab:parameterValues}
 Table \ref{tab:parameterValues1}
 
```{r parameterValues, echo=F}

#specify parameters for parameter table 
theta <- 3
alpha <- 3 + .32*1
beta <- 180
gamma <- 20

sd_alpha <- 0.05
sd_theta <- 0.05
sd_beta <- 10
sd_gamma <- 4

sd_error <- 0.05


#table of parameter values
parameterValues_df <- data.frame('Parameter Means' = c(
                                         'Baseline, $\\theta$',
                                         'Maximal elevation, $\\alpha$', 
                                         'Days-to-halfway elevation, $\\upbeta$', 
                                         'Triquarter-halfway delta, $\\upgamma$', 
                                         
                         'Variability and Covariability Parameters (in Standard Deviations)', 
                              'Baseline standard deviation, $\\uppsi_{\\uptheta}$',
                              'Maximal elevation standard deviation, $\\uppsi_{\\upalpha}$', 
                              'Days-to-halfway elevation standard deviation, $\\uppsi_{\\upbeta}$',
                              'Triquarter-halfway delta standard deviation, $\\uppsi_{\\upgamma}$',
                         
                              'Baseline-maximal elevation covariability, $\\uppsi_{\\uptheta\\upalpha}$',
                              'Baseline-days-to-halfway elevation covariability, $\\uppsi_{\\uptheta\\upbeta}$',
                              'Baseline-triquarter-halfway delta covariability, $\\uppsi_{\\uptheta\\upgamma}$',
                         
                              'Maximal elevation-days-to-halfway elevation covariability, $\\uppsi_{\\upalpha\\upbeta}$',
                              'Maximal elevation-triquarter-halfway delta covariability, $\\uppsi_{\\upalpha\\upgamma}$',
                         
                              'Days-to-halfway elevation-triquarter-halfway delta covariability, $\\uppsi_{\\upbeta\\upgamma}$',
                          
                              'Residual standard deviation, $\\uppsi_{\\upepsilon}$'), 
                         'Value' = c( theta, alpha, beta, gamma, 
                                     '', sd_theta, sd_alpha, sd_beta, sd_gamma, 
                                     0, 0, 0, 0, 0,0,  sd_error), check.names = F)

#round numbers to that they print with two significant numbers
parameterValues_df$Value <- round(as.numeric(as.character(parameterValues_df$Value)), 3)
parameterValues_df$Value <- formatC(round(parameterValues_df$Value, 3), format='f', digits=2)

#replace '  NA' with empty string 
parameterValues_df$Value[parameterValues_df$Value ==" NA"] <- ''


kbl(parameterValues_df, booktabs = TRUE, format = 'html', 
    align = c('l', 'c'),
    caption = 'Values Used for Multilevel Logistic Function Parameters',    
    escape = F) %>%
    add_indent(positions = c(1:4, 6:16), level_of_indent = 2) %>%
  kable_styling(position = 'center') %>%
  footnote(general =  "<em>Note</em>. The difference between $\\alpha$ and $\\theta$ corresponds to the 50$\\mathrm{^{th}}$ percentile Cohen's $d$ value of 0.32 in organizational psychology (Bosco et al., 2015). Additional text to see what happens",  threeparttable = T,  escape = F, general_title = ' ') %>% 
  row_spec(row = 4, extra_css = 'padding-bottom: 1rem; border-bottom: 1.5px solid') %>%
 row_spec(row = 5, extra_css = 'font-weight: bold; border-bottom: 1.5px solid')
```

```{r parameterValues1, echo=F}

#specify parameters for parameter table 
theta <- 3
alpha <- 3 + .32*1
beta <- 180
gamma <- 20

sd_alpha <- 0.05
sd_theta <- 0.05
sd_beta <- 10
sd_gamma <- 4

sd_error <- 0.05


#table of parameter values
parameterValues_df <- data.frame('Parameter Means' = c(
                                         'Baseline, $\\theta$',
                                         'Maximal elevation, $\\alpha$', 
                                         'Days-to-halfway elevation, $\\upbeta$', 
                                         'Triquarter-halfway delta, $\\upgamma$', 
                                         
                         'Variability and Covariability Parameters (in Standard Deviations)', 
                              'Baseline standard deviation, $\\uppsi_{\\uptheta}$',
                              'Maximal elevation standard deviation, $\\uppsi_{\\upalpha}$', 
                              'Days-to-halfway elevation standard deviation, $\\uppsi_{\\upbeta}$',
                              'Triquarter-halfway delta standard deviation, $\\uppsi_{\\upgamma}$',
                         
                              'Baseline-maximal elevation covariability, $\\uppsi_{\\uptheta\\upalpha}$',
                              'Baseline-days-to-halfway elevation covariability, $\\uppsi_{\\uptheta\\upbeta}$',
                              'Baseline-triquarter-halfway delta covariability, $\\uppsi_{\\uptheta\\upgamma}$',
                         
                              'Maximal elevation-days-to-halfway elevation covariability, $\\uppsi_{\\upalpha\\upbeta}$',
                              'Maximal elevation-triquarter-halfway delta covariability, $\\uppsi_{\\upalpha\\upgamma}$',
                         
                              'Days-to-halfway elevation-triquarter-halfway delta covariability, $\\uppsi_{\\upbeta\\upgamma}$',
                          
                              'Residual standard deviation, $\\uppsi_{\\upepsilon}$'), 
                         'Value' = c( theta, alpha, beta, gamma, 
                                     '', sd_theta, sd_alpha, sd_beta, sd_gamma, 
                                     0, 0, 0, 0, 0,0,  sd_error), check.names = F)

#round numbers to that they print with two significant numbers
parameterValues_df$Value <- round(as.numeric(as.character(parameterValues_df$Value)), 3)
parameterValues_df$Value <- formatC(round(parameterValues_df$Value, 3), format='f', digits=2)

#replace '  NA' with empty string 
parameterValues_df$Value[parameterValues_df$Value ==" NA"] <- ''


kbl(parameterValues_df, booktabs = TRUE, format = 'html', 
    align = c('l', 'c'),
    caption = 'Values Used for Multilevel Logistic Function Parameters (see Table \\ref{tab:parameterValues})',    
    escape = F) %>%
    add_indent(positions = c(1:4, 6:16), level_of_indent = 2) %>%
  kable_styling(position = 'center') %>%
  footnote(general =  "<em>Note</em>. The difference between $\\alpha$ and $\\theta$ corresponds to the 50$\\mathrm{^{th}}$ percentile Cohen's $d$ value of 0.32 in organizational psychology (Bosco et al., 2015). see Table \\ref{tab:parameterValues} and Figure \\ref{fig:gg-oz-plot1}.",  threeparttable = T,  escape = F, general_title = ' ') %>% 
  row_spec(row = 4, extra_css = 'padding-bottom: 1rem; border-bottom: 1.5px solid') %>%
 row_spec(row = 5, extra_css = 'font-weight: bold; border-bottom: 1.5px solid')
```

```{r gg-oz-plot, eval=F, echo=F}
generate_apa7_figure <- function(fig_label, fig_title, fig_path, fig_note=NA){
  
    html_figure <- paste('<div class= "figure"> <caption class = "figTop"> <span class="figLabel">Figure ', fig_label,  
                         '</span> <br> <span class = "figTitle"> <em>', fig_title, 
                         '</em></span> </caption> <img src=', fig_path, '/>', sep = '')

  if(!is.na(fig_note)) { 
    html_fig_note <- paste('<span class="figNote"><em>Note. </em>', fig_note, '</span> </div>', sep = '')
  }
    
  else{ 
     html_fig_note <- paste('</div>', sep = '')
    }
  
    
  html_complete_figure <- paste(html_figure, html_fig_note)
  
  return(noquote(html_complete_figure))
}

x <- generate_apa7_figure(fig_label = '\ref{fig:gg-oz-plot}', fig_title = 'Title of Figure', fig_path = 'index_files/figure-html/gg-oz-plot-1.png', fig_note = 'Life expectancy from 1952 - 2007 for Australia. Life expentancy increases steadily except from 1962 to 1969. We can safely say that our life expectancy is higher than it has ever been!')


```

<div class= "figure"> <caption class = "figTop"> <span class="figLabel">Figure \ref{fig:gg-oz-plot}</span> <br> <span class = "figTitle"> <em>Title of Figure</em></span> </caption> <img src=index_files/figure-html/gg-oz-plot-1.png> <span class="figNote"><em>Note. </em>Life expectancy from 1952 - 2007 for Australia. Life expentancy increases steadily except from 1962 to 1969. We can safely say that our life expectancy is higher than it has ever been!</span> </div>   
 


Figure \ref{fig:gg-oz-plot} 


### References

{{< bibliography cited >}}






